<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  
  
  
  
  
  <link rel="prev" href="https://unionpan.github.io/2023/2023-01-16-hpbound/" />
  <link rel="next" href="https://unionpan.github.io/2023/2023-02-05-smallballrevisit/" />
  <link rel="canonical" href="https://unionpan.github.io/2023/2023-01-31-wardropequilibrium/" />
  <link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Wardrop Equilibrium | union&#39;s blog
       
  </title>
  <meta name="title" content="Wardrop Equilibrium | union&#39;s blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Wardrop Equilibrium"/>
<meta name="twitter:description" content="I remember having those unpleasant lines in our high school canteen, flooded by the starving students queeing for their lunch, I would always pick a window with fewer people waiting, compromising myself with awful food. Another similar thought that always stricked me was the odds that tourists always pick the same time to travel, there&rsquo;s almost always traffic congestion everywhere during holiday seasons. Yeah, lives have been always so hard."/>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Wardrop Equilibrium",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/unionpan.github.io\/2023\/2023-01-31-wardropequilibrium\/"
  },
  "image": {
    "@type": "ImageObject",
    "url": "https:\/\/unionpan.github.io\/cover.png",
    "width":  800 ,
    "height":  600 
  },
  "genre": "posts",
  
  "wordcount":  1325 ,
  "url": "https:\/\/unionpan.github.io\/2023\/2023-01-31-wardropequilibrium\/",
  "datePublished": "2023-01-30T00:00:00\u002b00:00",
  "dateModified": "2023-01-30T00:00:00\u002b00:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "union",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/unionpan.github.io\/logo.png",
      "width":  127 ,
      "height":  40 
    }
  },
  "author": {
    "@type": "Person",
    "name": "union"
  },
  "description": ""
}
</script>
  <!DOCTYPE html>

<html>

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
        integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
        crossorigin="anonymous"></script>

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
</head>
...

</html>
</head>

  



  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="https://unionpan.github.io">union&#39;s blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="about" title="">About</a>
                
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;<a href="https://unionpan.github.io">union&#39;s blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="about" title="">About</a>
                
        </div>
    </div>
</nav>

    	 <main class="main">
          <div class="container">
      		
<article class="post-warp">
    <header class="post-header">
        <h1 class="post-title">Wardrop Equilibrium</h1>
        <div class="post-meta">
            
                <span class="post-time">
                    on <time datetime=2023-01-30 >30 January 2023</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://unionpan.github.io/categories/game-theory/"> Game Theory </a>
                        
                </span>
                <i class="iconfont icon-timer"></i>
                7 min
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <p>I remember having those unpleasant lines in our high school canteen, flooded by the starving students queeing for their lunch, I would always pick a window with fewer people waiting, compromising myself with awful food.
Another similar thought that always stricked me was the odds that tourists always pick the same time to travel, there&rsquo;s almost always traffic congestion everywhere during holiday seasons. Yeah, lives have been always so hard.<br>
On the first level of thinking, when there&rsquo;s a lack of resource you attempt to find alternatives, e.g., picking another time for traveling, another food window, etc.. The level two thinking is maybe &lsquo;&lsquo;since other people are avoiding holidays, what if I insist on going out on holidays&rsquo;&rsquo;? Or maybe there&rsquo;s a twisted level three thinking, &lsquo;&lsquo;what if everybody thinks like the level two thinker, &hellip;.&rsquo;&rsquo; It&rsquo;s somewhat intimidating to follow this infinite hierachy, but definitely rewarding, as there are certainly moments when people are regretting their travel decisions, thinking to themselves &lsquo;&lsquo;I probably should not have gone the high way.&rsquo;&rsquo;</p>
<p>The aforementioned phenomenons significantly resembled the first idea proposed by Wardrop<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> in 1952. Wardrop conducted some &ldquo;before-and-after&rdquo; analysis over some traffic data, and came into the two alternative criteria to determine the flow distribution on the routes,</p>
<ol>
<li>The  journey  times on all the routes  actually used are  equal, and less than those which would be  experienced by a  single vehicle on any unused  route;</li>
<li>The  average  journey  time  is a minimum.</li>
</ol>
<p>It was not until Beckmann<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>, 1956 that the two simple yet powerful ideas were mathematically formulated, and was considered an example of Rosenthal games<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>. The first principle basically states that nobody should be happy to deviate from their own routes, which is essentially the behavior of Nash equilibrium.</p>
<p>To elaborate, we consider a transporation network represented by a directed, finite, and connected graph \( \mathcal{G} = (\mathcal{V}, \mathcal{E})\), where \(\mathcal{V}\) represent road junctions, the edges \(\mathcal{E}\) represent road segments. The set of Origin-Destination (OD) pairs is \(\mathcal{W} \subseteq \mathcal{V} \times \mathcal{V}\), indexed by \(w\), \(|\mathcal{W}| = :W\).  Let \(\mathcal{P}: = \bigcup_{w\in\mathcal{W}}\mathcal{P}_w\) be the set of directed paths between OD pairs, each path set \(\mathcal{P}_w\) is indexed by \(w\).</p>
<p>The individual vehicles traveling through \(\mathcal{G}\) are infinitesimal players over \(\mathcal{G}\), denoted by a measurable space \((\mathcal{X}, \mathcal{M}, m)\). The players are non-atomic, i.e., \( m(x) = 0 \ \ \forall x \in \mathcal{X}\); they are split into distinct populations indexed by the OD pairs, i.e., \(\mathcal{X} = \bigcup_{w\in\mathcal{W}} \mathcal{X}_w\) and  \(\mathcal{X}_w \bigcap\) \(\mathcal{X}_w&rsquo; = \emptyset,\ \forall w, w^{&rsquo;} \in \mathcal{W}\).
For each OD pair \(w \in \mathcal{W}\), let \(m_w = m(\mathcal{X}_w) \) represent the traffic demand.  For each player \(x \in \mathcal{X}_w\), we assume that their travel path \(a \in \mathcal{P}_w\) is fixed right after the path selection.</p>
<p>The action profile of all the players \(\mathcal{X}\) induces an edge flow vector \(q \in \mathbb{R}^{|\mathcal{E}|}_+\), where \(q_e := \int_{\mathcal{X}} \mathbb{I}_{{e \in a}}  m(dx), e \in \mathcal{E}\), and a path flow vector \(\mu \in \Delta :=\{(\mu_p)_{p\in \cup_{w\in \mathcal{W}}\mathcal{P}_w} | \mu_p := {\int_{\mathcal{X}_w} \mathbb{I}_{{a = p}} m(dx)}\}\). The edge-path incident matrix is \(\Lambda = [\Lambda^1 \vert , \ldots, \vert \Lambda^{|\mathcal{W}|}] \in \mathbb{R}^{|\mathcal{E}| \times |\mathcal{P}|}\), \(\Lambda^w_{e, p} = \mathbb{I}_{{e\in p}}, \forall e\in \mathcal{E}, w \in \mathcal{W}, p \in \mathcal{P}_w\). Easy to verify the compact form of edge-path flow relation is \(q = \Lambda \mu\).</p>
<p>Let \((\Omega, \mathcal{F}, \mathbb{P})\) be the probability space, \(l_e: \mathbb{R}_+ \times \Omega \to \mathbb{R}_+\) be the cost/latency functions, measuring the travel delay of the edge \(e \in \mathcal{E}\) determined by its edge flow \(q_e\) and a state variable \(\omega \in \Omega\) that is universal for the entire traffic network, e.g., \(\omega\) can represent the weather condition, road incidents or anything that affects the congestion level. Let \(l : \mathbb{R}^{|\mathcal{E}|}_{\geq 0} \times \Omega \mapsto \mathbb{R}^{|\mathcal{E}|}_+\) denote the vector-valued latency function.For an instance \(\omega \in \Omega\), the latency of path \(p\) is defined as \(\ell_p : = \sum_{e \in p} l_e (q_e, \omega ) = \Lambda^{\top}_p l (\Lambda \mu, \omega )\), which can be seen as a function of \(\mu\) and \(\omega\), written as \(\ell_p = \ell_p(\mu, \omega)\). We write the vector-valued path latency function as \(\ell : \Delta \times \Omega \mapsto \mathbb{R}^{|\mathcal{P}|}_+\). Each instance \(\omega\) determines a congestion game, captured by the tuple \(\mathcal{G}_c^{\omega} = ( \mathcal{G}, \mathcal{W}, \mathcal{X} , \mathcal{P}, \mathcal{\ell}(\cdot, \omega) )\). Each path flow profile \(\mu \in \Delta\) induces a probability measure associated with the positive random vector \(\ell(\mu, \cdot): \Omega \mapsto \mathbb{R}^{|\mathcal{P}|}_+\). The following assumption gives some realistic properties for the latency.</p>
<h4 id="standing-assumption">Standing Assumption</h4>
<blockquote>
<p>For all \(e \in \mathcal{E}\), the latency functions \(l_e\) are \(\omega\)-measurable, for all \(\omega \in \Omega\), \(l_e\) are \(L_0\)-Lipschitz continuous and differentiable in \(q_e\) with \(\cfrac{ \partial l_e (q_e, \omega)}{\partial q_e} &gt; 0 \) for all \(q_e \geq 0\).</p>
</blockquote>
<p>Now let&rsquo;s define and find the equilibria satisfying  of a deterministic game, i.e., when \(|\Omega|\) is a singleton. The first, as it turns out, coincides with the Nash Equilibrium.</p>
<h4 id="definition-wardrop-equilibrium">Definition (Wardrop Equilibrium)</h4>
<blockquote>
<p>A path flow \(\mu \in \Delta\) is said to be a  Wardrop Equilibrium (WE) if \(\forall w \in \mathcal{W}\), \( \mu_p &gt; 0\) indicates \( \ell_p \leq \ell_{p^{\prime}}\) for all \(p^{\prime} \in \mathcal{P}_w\).</p>
</blockquote>
<p>The second, while not satisfying the incentive conditions, somehow concides with the Nash equilibrium in a &ldquo;regularized&rdquo; version of the game, where the utility for each individual player is a sum of the latency and a &ldquo;toll price&rdquo;.</p>
<h4 id="definition-system-equilibrium">Definition (System Equilibrium)</h4>
<blockquote>
<p>A path flow \(\mu \in \Delta\) is said to be a system optimum if the aggregated latency \(S(\mu) := \sum_{e \in \mathcal{E}} q_e l_e \) is minimized.</p>
</blockquote>
<p>Wardrop equilibrium can be characterized by the minimization of an objective function called Beckmann potential, we end this post by proving it.</p>
<h4 id="theorem">Theorem</h4>
<blockquote>
<p>A path flow \(\mu^* \in \Delta\) is a WE if and only if it minimizes the Beckmann potential:
$$
\min_{\mu \in \Delta} \Phi (\mu) := \sum_{e\in \mathcal{E}}\int_{0}^{(\Lambda \mu)_e} l_e (z) dz.
$$</p>
</blockquote>
<h4 id="proof">Proof</h4>
<p>We first write down the constraint \(\Delta\) as a set of inequalities and equalities,
$$
\begin{align*}
-\mu &amp; \preceq 0  \\
M \mu -  \bf{m} &amp; = 0
\end{align*}
$$
where \(M \in \mathbb{R}^{W \times |\mathcal{P}|}\), \(M_{w,p} = 1\) if \(p \in \mathcal{P}_w\) otherwise \(0\), \(\boldsymbol{m} = (m_1, \ldots,  m_W)\) is the measure vector.</p>
<p>Writing down the Lagrangian, by defining multipliers \(\lambda \in \mathbb{R}^{|\mathcal{P}|}, \nu \in \mathbb{R}^{W}\),
let \(t_e = (0, \ldots, \underbrace{1}_{e^{th} edge}, \ldots, 0)\) be the basis vecotrs,
$$
\mathcal{L} (\mu , \lambda, \nu ) =  \sum_{e\in \mathcal{E}} \int_{0}^{(t_e \Lambda) \mu} l_e (z) dz - \lambda^{\top} \mu - \nu^{\top} (M\mu - \boldsymbol{m}).
$$</p>
<p>The KKT condition says,
$$
\begin{align*}
\nabla_{\mu} \mathcal{L} &amp; = \sum_{e \in \mathcal{E}} \Lambda^{\top} t_e^{\top} l_e(q_e ) -  \lambda - M^{\top}\nu  \\
&amp; = \ell - \lambda  - M^{\top}\nu = 0 \\
\lambda^{\top} \mu &amp; = 0 \\
\lambda &amp; \succeq 0
\end{align*}
$$
we get that \(\ell \succeq M^{\top} \nu\), \(\ell^{\top }\mu = \nu^{\top} M \mu\), what this essentially means is that whenever \(\mu_p &gt; 0\), \(\ell_p\) is identical in that path set \(\mathcal{P}_w\). To see this, note that \(\ell_p \geq (M^{\top} \nu)_p = \sum_{w \in \mathcal{W}} \nu_w \mathbb{I}_{ p \in \mathcal{P}_w }\), which is a constant lower bound for \(p \in \mathcal{P}_w\), fixing a \(w\); and \(\sum_{w \in \mathcal{W}}\sum_{p \in \mathcal{P}_w}\ell_p \mu_p = \sum_{w \in \mathcal{W}}\sum_{p \in \mathcal{P}_w} (M^{\top} \nu)_p \mu_p \), this implies that for any \(w \in \mathcal{W}\), if \(\mu_p &gt; 0\) for some of the \(p \in \mathcal{P}_w\), the only possibility is that \(\ell_p = (M^{\top}\nu)_p\).
The uniqueness of the edge flow solution \(q = \Lambda \mu\) can be established through calculating the Hessian of \(\Phi\), however, \(\mu\) is generally non-unique, as it should be in the solution set to a linear equation.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Wardrop, J.G., 1952. Road paper. some theoretical aspects of road traffic research. Proceedings of the institution of civil engineers, 1(3), pp.325-362.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Beckmann, M., McGuire, C.B. and Winsten, C.B., 1956. Studies in the Economics of Transportation (No. 226 pp).&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Rosenthal, R.W., 1973. A class of games possessing pure-strategy Nash equilibria. International Journal of Game Theory, 2(1), pp.65-67.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>

    <div class="post-copyright">
            
           
            

            <p class="copyright-item">
                
            </p>

            
    </div>

  
    <div class="post-tags">
        
        <section>
                <a href="javascript:window.history.back();">Back</a></span> · 
                <span><a href="https://unionpan.github.io">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://unionpan.github.io/2023/2023-01-16-hpbound/" class="prev" rel="prev" title="A Chernoff-Method for Mirror Descent"><i class="iconfont icon-dajiantou"></i>&nbsp;A Chernoff-Method for Mirror Descent</a>
         
        
        <a href="https://unionpan.github.io/2023/2023-02-05-smallballrevisit/" class="next" rel="next" title="Small Ball Revisit">Small Ball Revisit&nbsp;<i class="iconfont icon-xiaojiantou"></i></a>
        
    </div>

    <div class="post-comment">
          
          
    <script src="https://utteranc.es/client.js"
            repo="unionpan/"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

 

          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2021 - 2023</span>
        
         

		  
          <span> Regret has been lower bounded since. </span>
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  







     </div>
  </body>
</html>
